
import os
import logging


from helpers.ida import do, delete_i64_files
from helpers.logger import init_log

# Reference: https://blog.csdn.net/weixin_43872455/article/details/128265449
if __name__ == "__main__":
    init_log(
        log_path= "../outputs/" + os.path.splitext(os.path.basename(__file__))[0],
        stream_level = logging.INFO
    )
    ida_path = r"D:\software\IDApro\IDA_Pro_7.7\ida64.exe"
    # ########################## LargePE-unfiltered
    # # train
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\train\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\train\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)
    
    # # validate
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\validate\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\validate\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)
    
    # # test
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\test\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\test\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)

    ########################## LargePE-filtered
    # # train
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\train\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\train\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)
    
    # # validate
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\validate\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\validate\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)
    
    # # test
    # pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\PEs\test\\"
    # asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\LargePE-unfiltered\ASMs\test\\"
    # do(
    #     pe_file_dir=pe_file_dir,
    #     asm_save_dir=asm_save_dir,
    #     ida_path=ida_path
    # )
    # # delete_i64_files(asm_save_dir)
    
    
    ########################## virusshare-20
    # train
    pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\PEs\train\\"
    asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\ASMs\train\\"
    do(
        pe_file_dir=pe_file_dir,
        asm_save_dir=asm_save_dir,
        ida_path=ida_path
    )
    # delete_i64_files(asm_save_dir)
    
    # validate
    pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\PEs\validate\\"
    asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\ASMs\validate\\"
    do(
        pe_file_dir=pe_file_dir,
        asm_save_dir=asm_save_dir,
        ida_path=ida_path
    )
    # delete_i64_files(asm_save_dir)
    
    # test
    pe_file_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\PEs\test\\"
    asm_save_dir = r"E:\benchmarks\ConvProtoNet-datasets\virushare_20\ASMs\test\\"
    do(
        pe_file_dir=pe_file_dir,
        asm_save_dir=asm_save_dir,
        ida_path=ida_path
    )
    # delete_i64_files(asm_save_dir)